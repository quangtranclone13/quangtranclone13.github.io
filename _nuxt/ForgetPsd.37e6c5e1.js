import U from"./Form.074b64ba.js";import V from"./ScrollText.94455b24.js";import{I as u,u as D}from"./useGTag.98087ddc.js";import{d as M,r as w,K as _,q,L as s,aR as y,m as i,aS as x,aT as B,M as Q,o as P,a as h,f as a,t as f,h as b,u as v,w as j,N as z,aU as K,aV as W,W as Z}from"./entry.8cba7e1e.js";/* empty css                      */import{_ as H}from"./_plugin-vue_export-helper.a1a6add7.js";import"./Form.vue.05855c5e.js";import"./FormItemRender.vue.7116eee4.js";import"./Upload.74a010bf.js";import"./CountrySelect.aae122e7.js";import"./payment.81dfa3b1.js";import"./VerificationCodeInput.d58b074a.js";import"./useValidator.21496c0f.js";import"./timer.4152b58e.js";const J={class:"forget-password-title"},X={key:0,class:"forget-password-count"},Y={class:"forget-password-content"},ee={key:0,class:"go-back"},oe=M({__name:"ForgetPsd",props:{showPsd:{type:Boolean,default:!1},registryQuery:{default:()=>({})},showGoBack:{type:Boolean,default:!0},showPsdTitle:{type:Boolean,default:!0},sceneRecord:null},emits:["signInClick","submitReset"],setup(p,{emit:k}){const r=p;let{useLoginGTag:S}=D(),{_PointOfficialForgotPassword:d}=S();const F=W(),C=w(),E=w();let m=_({marginTop:"8px"});q(()=>{document.querySelector(".forget-password .el-form .el-input__inner").focus()});const G=async(e,t,o)=>{if(Z.test(t))if(r.showPsdTitle){let I=await K({email:n.email});return Object.keys(I).every(N=>I[N]===0)?o(new Error(s("login.forgetPsd.errEmail"))):o()}else return o();else return o(new Error(s("login.signIn.error")))},$=(e,t,o)=>{if(m.marginTop="25px",t.length<8||t.length>16)return o(new Error(s("login.signUp.errArr[2]")));if(/^[0-9]+$/.test(t))return o(new Error(s("login.signUp.errArr[0]")));if(/^[A-Za-z]+$/.test(t))return o(new Error(s("login.signUp.errArr[1]")));if(/[\u4e00-\u9fa5]+/.test(t)||/[ぁ-んァ-ヶ]+/.test(t)||/\s+/.test(t))return o(new Error(s("login.signUp.errArr[3]")));m.marginTop="8px",o()},A=(e,t,o)=>{t!==n.password?o(new Error(s("login.signUp.errPsdRepeat"))):o()};let n=_({email:"",password:"",password2:""}),l=w([{model:"email",type:"input",onBlur(){r.showGoBack&&!r.showPsd&&d({official_operate:u.input_email})},label:s("login.forgetPsd.codeLabel"),enterClick:!0,enterClickFn:()=>{g()}},{type:"input",model:"password",label:s("login.label.psd"),itype:"password",clearable:!0,slots:!0,onBlur(){r.sceneRecord===y.FORGET_PSD&&d({official_operate:u.input_new_password})},slotsFormatter(){let e=s("login.signUp.psdTip")+"@#$%^&*-_+=[]{}|\\:',?/`~\"();!.<>";return i("div",{class:"password-tooltip",style:m},[e])},suffixSlot(){return i("div",{class:"eyes-wrapper"},[i("span",{class:"eyes-wrapper-text"},null),i("img",{src:l.value[0].itype?x:B,class:"eyes-icon",onClick:()=>{R(0)}},null)])}},{type:"input",model:"password2",label:s("login.label.rPsd"),itype:"password",clearable:!0,onBlur(){r.sceneRecord===y.FORGET_PSD&&d({official_operate:u.input_new_password_again})},suffixSlot(){return i("div",{class:"eyes-wrapper"},[i("span",{class:"eyes-wrapper-text"},null),i("img",{src:l.value[1].itype?x:B,class:"eyes-icon",onClick:()=>{R(1)}},null)])},enterClick:!0,enterClickFn:()=>{g()}}]);const c=_({email:[{validator:G,trigger:"blur"}],password:[{validator:$,trigger:"blur"}],password2:[{validator:A,trigger:"blur"}]});Q(()=>r.showPsd,e=>{e?(l.value.splice(0,1),delete n.email,delete c.email):(l.value.length=1,delete c.password,delete c.password2,delete n.password,delete n.password2)},{immediate:!0});const R=e=>{l.value[e].itype=l.value[e].itype?"":"password"},O=()=>{k("signInClick")},g=()=>{setTimeout(()=>{E.value.validate()})},L=e=>{e&&(r.showGoBack&&!r.showPsd?d({official_operate:u.input_email_submit}):r.sceneRecord===y.FORGET_PSD&&d({official_operate:u.click_reset}),F.$loading({target:C.value}),k("submitReset",n))};return(e,t)=>{const o=U,T=V;return P(),h("div",{ref_key:"forgetRef",ref:C,class:"forget-password"},[a("div",J,f(p.showPsdTitle?e.$t("login.forgetPsd.title"):e.$t("login.forgetPsd.title2")),1),p.showPsd?(P(),h("div",X,[a("span",null,f(e.$t("login.forgetPsd.countDesc")),1),a("span",null,f(p.registryQuery.email),1)])):b("",!0),a("div",Y,[i(o,{ref_key:"formRef",ref:E,"form-inline":!1,"form-label-position":"top","form-model":v(n),"form-input-list":v(l),"form-rules":v(c),onValidate:L},null,8,["form-model","form-input-list","form-rules"]),a("div",{class:"submit-button",onClick:g},[i(T,null,{default:j(()=>[z("Submit")]),_:1})]),p.showGoBack?(P(),h("div",ee,[a("span",null,f(e.$t("login.forgetPsd.goBack")),1),a("span",{onClick:O},f(e.$t("login.signIn.title")),1)])):b("",!0)])],512)}}}),we=H(oe,[["__scopeId","data-v-1d8e112d"]]);export{we as default};
