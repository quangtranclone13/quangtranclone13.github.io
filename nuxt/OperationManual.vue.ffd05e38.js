import{d as V,bi as W,r as _,L as t,K as q,ad as J,ag as w,M as K,q as R,b as G,m as e,F as b,bo as H,bv as X,bw as j,bx as p,g as o,u as c,a7 as z,a1 as Q,X as Y,by as Z,x as ee,a9 as y,H as ne,aP as te,br as ie,y as ae}from"./entry.8cba7e1e.js";import{a as se,u as T}from"./useValidator.21496c0f.js";import{s as g}from"./download.e4c9c7c8.js";const de=V({props:{showNotification:{type:Boolean,default:!1},email:{type:String,default:""},source:{type:String,default:W.Website},timeId:{type:[String,Number],default:()=>""},removeTimeId:{type:Boolean,default:()=>!1}},setup(a){const x="https://evoto.ai/download",f=_(t("download.help.steps[1].btnText")),{useCommonMp:v}=H(),{_pointMpWebsiteJoinFb:k}=v(),l=q({email:a.email}),{email:M}=J(l),r=_(!1),{validator:h,isError:I,errorMessage:S}=se({target:M});a.removeTimeId&&(localStorage.removeItem(`${w.COUNTDOWN_TIMESTAMP}__manual_t1_${a.timeId}`),localStorage.removeItem(`${w.COUNTDOWN_TIMESTAMP}__manual_t2_${a.timeId}`));const{count:C,timekeeping:E,isTiming:m}=T({sId:`_manual_t1_${a.timeId}`}),{count:N,timekeeping:O,isTiming:d}=T({sId:`_manual_t2_${a.timeId}`});async function $(){try{if(!h())return;r.value=!0,await g(l.email),p(t("download.help.steps[0].sentMsg")),E()}catch{y(t("download.help.steps[0].failMsg"))}finally{r.value=!1}}async function L(){if(!c(d))try{await g(l.email),p(t("download.help.steps[0].sentMsg")),O()}catch{y(t("download.help.steps[0].failMsg"))}}let u;K(r,i=>{if(i){const s=document.querySelector(".email-action-btn");u=ne({target:s}).close}else u&&u()}),R(()=>{setTimeout(()=>{!d.value&&l.email&&g(l.email)})});const D=G(()=>[{children:[{title:t("download.help.steps[0].title"),type:"emailInput",placeholder:"Email Address",icon:X,async onClick(){await $()},eventListener:{onBlur(){h()}},btnText:t("download.help.steps[0].btnText"),model:"email"},{type:"divider",dividerText:"or"},{type:"link",async onClick(){await j(x),p(t("download.help.steps[1].copiedMsg")),f.value=t("download.help.steps[1].copiedBtnText")},btnText:f.value,title:t("download.help.steps[1].title"),imgUrl:o("/assets/images/pages/landing/landing_download_operation_img.png")}]}]);async function U(){const{isIOS:i}=te();k({endPoint:"OS",source:a.source});let s=await ie();c(i)?location.href=s:window.open(s,"_blank")}function B(){return D.value.map((s,n)=>e("div",{class:"operation-manual__item"},[e("div",{class:"operation-manual__item-content"},[s.children&&i(s.children)])]));function i(s){return s.map(n=>{if(n.type==="emailInput")return e(b,null,[a.email?e("div",{class:"input-item-email"},[e("img",{src:o("/assets/images/pages/download/email-icon.png")},null),e("span",{class:"input-item-email_s"},[t("download.help.steps[0].sentMsg2")]),e("div",{class:"input-item-email_control"},[e("span",{class:"control-t"},[t("download.help.steps[0].receive")]),e("span",{class:["control-btn",c(d)?"control-btn-disabled":""],onClick:L},[c(d)?c(N):t("download.help.steps[0].resend")])])]):e("div",{class:"input-item children"},[e("div",{class:"input-item_title"},[n.title]),e(z,Q({modelValue:l[n.model],"onUpdate:modelValue":A=>l[n.model]=A,disabled:n.disabled,placeholder:n.placeholder},n.eventListener,{class:"input-item__content"}),{prefix:()=>n.icon?Y(n.icon):null}),n.model==="email"&&e(Z,null,{default:()=>ee(e("div",{class:"error-msg"},{default:()=>S.value}),[[ae,()=>I.value]])}),e("div",{class:[m.value?"action-btn-wrapper":""]},[e("button",{class:["action-btn",`${n.model}-action-btn`,m.value?"action-btn-disabled":""],onClick:n.onClick},[n.model==="email"&&m.value?`${C.value}s`:n.btnText])]),n.children&&i(n.children)])]);if(n.type==="img")return e("div",{class:"img-item children"},[e("img",{src:n.imgUrl},null),n.children&&i(n.children)]);if(n.type==="text")return e("p",{class:"text-item children"},[e("img",{class:"text-item__icon",src:n.icon},null),n.text,n.children&&i(n.children)]);if(n.type==="divider")return e("div",{class:"divider children"},[e("span",{class:"divider-text"},[n.dividerText])]);if(n.type==="link")return e("div",{class:"link-wrapper"},[e("div",{class:"link-wrapper_t"},[e("span",null,[n.title]),e("div",{class:"link-btn",onClick:n.onClick},[e("img",{src:o("/assets/icons/common/mail-link.png","icons")},null),e("span",null,[n.btnText])])]),e("img",{src:n.imgUrl},null)])})}}function F(){return a.showNotification&&e("div",{class:"notification"},[e("div",{class:"top-text"},[t("download.help.notification.text1")]),e("div",{class:"n-content"},[e("div",{class:"n-left"},[e("img",{src:o("/assets/icons/common/user-list.png","icons")},null),e("span",null,[t("download.help.notification.text2")])]),e("div",{class:"n-btn",onClick:U},[e("img",{class:"icon",src:o("/assets/icons/common/f-vector.png","icons")},null),e("span",{class:"text"},[t("download.help.notification.btnText")])])])])}function P(){return e("p",{class:"tip"},[e("img",{class:"tip__icon",src:o("/assets/icons/common/warning.png","icons")},null),t("download.help.tip")])}return()=>e(b,null,[e("div",{class:"operation-manual"},[B()]),F(),P()])}});export{de as _};
