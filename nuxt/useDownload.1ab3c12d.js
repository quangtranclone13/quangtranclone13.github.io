import{bh as $,K as C,b as m,m as A,an as I,bi as P,r as g,bj as R,aP as j,bk as E,aN as F,n as N,aA as U,bl as q,u as l,bm as x,bn as J}from"./entry.8cba7e1e.js";import{f as K,g as M}from"./download.e4c9c7c8.js";import{S as h}from"./download.e1381952.js";import V from"./ThanksDialog.323617ee.js";const W=$("app",()=>{const e=C({softwareList:[],flag:!1,softwareType:h.Trial}),s=m(()=>e.softwareList.filter(a=>a.type===e.softwareType)),o=m(()=>e.softwareList.filter(a=>a.type===h.Channel));async function n(){try{if(e.softwareList.length||e.flag)return;e.flag=!0;const a=await K();e.softwareList=a}catch(a){console.log(a),Promise.reject(a)}finally{e.flag=!1}}return{downloadState:e,getSoftwareList:s,getSoftwareChannelList:o,fetchSoftwareList:n}});function z(e={}){const{source:s}=e,o=A(V,{source:s});I(o,document.createElement("div"))}function Q(e={}){const{source:s=P.Website}=e,o=g(!1),n=g(!1),a=W(),{fetchSoftwareList:f}=a,{getSoftwareList:S,getSoftwareChannelList:v}=R(a),{isMobile:i}=j();f();async function y(c){var w;const L=F();if(!c||i.value){const t=(w=L.userInfo)==null?void 0:w.email;i.value&&N(`/download/help${t?`?e=${t}`:""}`);return}o.value=!0;const u=J[c];await f();let{package_url:T}=S.value.find(t=>t.app_type===u);n.value||(z({source:s}),n.value=!0);const d=U().query.sId,r=q();if(d||l(r)){const t=l(r)?x[l(r)]:d,{id:D}=v.value.find(k=>k.app_type===u),{download_url:_,file_name:p}=await M(t,{id:D});location.href=`${_}${p?`filename=${p}`:""}`,o.value=!1}else location.href=T,o.value=!1}const b=E(y,1e3);return{loading:o,download:b}}export{W as a,Q as u};
